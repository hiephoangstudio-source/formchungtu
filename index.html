<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng In Bi·ªÉu M·∫´u 2H Studio</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Times+New+Roman:ital,wght@0,400;0,700;1,400;1,700&display=swap');
        
        * { box-sizing: border-box; }

        body { 
            font-family: 'Times New Roman', serif; 
            color: #000; 
            background-color: #525659; 
            margin: 0; padding: 0; 
        }

        /* --- TOOLBAR --- */
        .actions-container { 
            position: sticky; top: 0; 
            display: flex; align-items: center; justify-content: center; gap: 15px;
            width: 100%; background-color: #343a40; padding: 10px; z-index: 2000; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .control-group { display: flex; align-items: center; gap: 8px; background: #495057; padding: 5px 12px; border-radius: 4px; color: white; }
        .control-label { font-size: 14px; font-weight: bold; }
        .action-btn { background-color: #0d6efd; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; height: 38px; font-weight: bold; }
        .action-btn:hover { background-color: #0b5ed7; }
        .mode-select { padding: 0 10px; border-radius: 4px; border: 1px solid #ccc; height: 38px; cursor: pointer; outline: none; font-weight: 500; }
        .hidden { display: none !important; }

        /* --- PAGE SETUP --- */
        .page-wrapper { display: flex; justify-content: center; padding: 30px; min-height: 100vh; }
        .a4-page {
            width: 210mm;
            min-height: 296mm; 
            background: white;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
            margin: auto;
            overflow: hidden; 
            position: relative;
            padding: 10mm 12mm; /* Padding m·∫∑c ƒë·ªãnh cho Form 1 & 2 */
        }

        .form-container { display: none !important; width: 100%; height: 100%; }
        .form-container.active { display: block !important; }

        /* UTILS */
        .bold { font-weight: bold; }
        .italic { font-style: italic; }
        .center { text-align: center; }
        .right { text-align: right; }
        .uppercase { text-transform: uppercase; }

        /* ==================== CSS FORM 1 & 2 (GI·ªÆ NGUY√äN) ==================== */
        
        .voucher-section-half { height: 48%; display: flex; flex-direction: column; padding: 0 2px; overflow: hidden; }
        .voucher-section-half.top { padding-bottom: 10px; }
        .voucher-section-half.bottom { padding-top: 25px; }
        .middle-gap { height: 4%; display: flex; align-items: center; justify-content: center; width: 100%; }
        .cut-line { width: 100%; border-top: 1px dashed #000; height: 1px; }

        /* Form 1 CSS */
        #form-handover { padding: 0; font-size: 10pt; } 
        #form-handover .header-section { display: flex; justify-content: space-between; margin-bottom: 10px; }
        #form-handover .main-title { font-size: 18pt; font-weight: bold; text-align: center; text-transform: uppercase; margin: 0; }
        #form-handover table { width: 100%; border-collapse: collapse; margin-top: 10px; margin-bottom: 10px; font-size: 10pt; }
        #form-handover th, #form-handover td { border: 1px solid #000; padding: 4px; text-align: center; vertical-align: middle; }
        #form-handover .sig-block { margin-top: 15px; }
        #form-handover .sig-header-row { display: flex; justify-content: space-between; margin-bottom: 5px; align-items: flex-end;}
        #form-handover .sig-section-title { font-weight: bold; font-size: 11pt; text-decoration: underline; }
        #form-handover .sig-grid { display: flex; justify-content: space-between; text-align: center; }
        #form-handover .sig-col { width: 19%; }
        #form-handover .sig-role { font-weight: bold; font-size: 10pt; margin-bottom: 2px; }
        #form-handover .sig-note { font-style: italic; font-size: 9pt; }
        #form-handover .sig-space { height: 40px; }

        /* Form 2 CSS */
        #form-invoice { padding: 0; font-size: 9.5pt; }
        #form-invoice .header-section { display: flex; justify-content: space-between; margin-bottom: 2px; }
        #form-invoice .main-title { font-size: 16pt; font-weight: bold; text-transform: uppercase; margin: 0; text-align: center; margin-bottom: 2px; }
        #form-invoice .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 2px; }
        #form-invoice .form-row { display: flex; align-items: baseline; margin-bottom: 2px; }
        #form-invoice .label { font-weight: normal; min-width: 60px; }
        #form-invoice .value { flex: 1; border-bottom: 1px dotted #000; padding-left: 5px; font-weight: bold; font-size: 9.5pt; }
        #form-invoice table { width: 100%; border-collapse: collapse; margin-top: 2px; font-size: 9.5pt; }
        #form-invoice th, #form-invoice td { border: 1px solid #000; padding: 3px; vertical-align: middle; }
        #form-invoice td { height: 20px; }
        #form-invoice .signatures { display: flex; justify-content: space-between; text-align: center; margin-top: 5px; }
        #form-invoice .sig-col { width: 19%; }
        #form-invoice .sig-title { font-weight: bold; font-size: 8pt; text-transform: uppercase; margin-bottom: 1px; }
        #form-invoice .sig-note { font-style: italic; font-size: 8pt; margin: 0; } 
        #form-invoice .sig-space { height: 50px; }

        /* ==================== CSS FORM 3 (T·ªêI ∆ØU C·ª∞C ƒê·∫†I - 3MM ALL SIDES) ==================== */
        
        /* Ghi ƒë√® padding trang ri√™ng cho Form 3: 3mm Top/Bottom, 3mm Left/Right */
        #form-work-wrapper { 
            padding: 3mm 3mm !important; /* ƒê√É CH·ªàNH: 3mm to√†n b·ªô c√°c c·∫°nh */
            height: 100%;
            display: flex; flex-direction: column;
        }

        #form-work .header-section { 
            display: flex; justify-content: space-between; 
            border-bottom: 1px solid #ccc; 
            padding-bottom: 2px; margin-bottom: 2px; 
        }
        #form-work .studio-name { font-size: 10pt; font-weight: bold; display: block; margin-bottom: 1px; }
        #form-work .studio-info { font-size: 9pt; display: block; margin-bottom: 0; }
        
        #form-work .main-title { 
            font-size: 14pt; font-weight: bold; text-align: center; 
            margin: 3px 0 1px 0; text-transform: uppercase; line-height: 1.1; 
        }
        #form-work .date-sub { font-size: 9pt; font-style: italic; text-align: center; margin-bottom: 4px; }

        #form-work .section-title { 
            font-size: 9pt; font-weight: bold; text-transform: uppercase; 
            background-color: #f0f0f0; border-left: 3px solid #333; 
            padding: 2px 5px; margin: 4px 0 2px 0; 
        }

        #form-work .info-grid { display: flex; flex-wrap: wrap; margin-bottom: 2px; font-size: 9pt; line-height: 1.2; }
        #form-work .info-row { width: 100%; display: flex; align-items: baseline; margin-bottom: 1px; }
        #form-work .label { font-weight: bold; min-width: 70px; }
        #form-work .value { flex: 1; border-bottom: 1px dotted #999; padding-left: 5px; font-weight: normal; }
        #form-work .value.bold { font-weight: bold; }

        #form-work table { width: 100%; border-collapse: collapse; font-size: 8.5pt; } 
        #form-work th, #form-work td { 
            border: 1px solid #000; 
            padding: 1px 3px; 
            vertical-align: middle; 
        }
        #form-work th { background-color: #eee; font-weight: bold; text-align: center; height: 18px; }

        #form-work .ekip-table td { height: 16px; }

        #form-work .check-table .col-time { width: 9%; text-align: center; font-weight: bold; background: #f9f9f9; }
        #form-work .check-table .col-role { width: 12%; text-align: center; font-weight: bold; }
        #form-work .check-table .col-check { width: 35px; text-align: center; }

        #form-work .eval-table th { font-size: 8.5pt; }
        
        #form-work .footer-note { font-size: 8.5pt; font-style: italic; margin-top: 3px; text-align: justify; line-height: 1.1; }

        #form-work .signatures { display: flex; justify-content: space-between; margin-top: 8px; text-align: center; }
        #form-work .sig-col { width: 24%; }
        #form-work .sig-title { font-size: 9pt; font-weight: bold; text-transform: uppercase; margin-bottom: 1px; }
        #form-work .sig-note { font-size: 8.5pt; font-style: italic; font-weight: normal; margin-bottom: 40px; }
        #form-work .sig-name { font-size: 9pt; font-weight: bold; }


        @media print {
            body, html { margin: 0; padding: 0; background: #fff; }
            .actions-container { display: none !important; }
            .page-wrapper { display: block; padding: 0; margin: 0; }
            .a4-page { box-shadow: none; margin: 0; width: 100%; height: auto; }
            .form-container { display: none !important; }
            .form-container.active { display: block !important; }
            
            /* Print Specific Overrides for Form 3: 3mm Padding All Sides */
            #form-work-wrapper { padding: 3mm 3mm !important; }
        }
    </style>
</head>
<body>

    <!-- TOOLBAR -->
    <div class="actions-container">
        <div class="control-group">
            <span class="control-label">üìë Ch·ªçn M·∫´u:</span>
            <select id="main-form-selector" class="mode-select" onchange="switchForm(this.value)">
                <option value="form-handover">1. Bi√™n B·∫£n Giao Nh·∫≠n</option>
                <option value="form-invoice">2. H√≥a ƒê∆°n B√°n H√†ng</option>
                <option value="form-work">3. X√°c Nh·∫≠n C√¥ng Vi·ªác</option>
            </select>
        </div>

        <div id="invoice-controls" class="control-group hidden">
            <span class="control-label">üñ®Ô∏è Ch·∫ø ƒë·ªô In Hƒê:</span>
            <select id="invoice-print-mode" class="mode-select" onchange="changeInvoiceMode(this.value)">
                <option value="both">In 2 Li√™n (A4)</option>
                <option value="lien1">Ch·ªâ Li√™n 1</option>
                <option value="lien2">Ch·ªâ Li√™n 2</option>
            </select>
        </div>

        <button onclick="window.print()" class="action-btn">üñ®Ô∏è In Ngay</button>
        <button onclick="downloadPDF()" class="action-btn">üì• T·∫£i PDF</button>
    </div>

    <!-- MAIN PAGE -->
    <div class="page-wrapper">
        <div class="a4-page" id="print-area">
            <div id="form-handover" class="form-container"></div>
            <div id="form-invoice" class="form-container"></div>
            <!-- Wrapper Form 3 v·ªõi padding 3mm -->
            <div id="form-work" class="form-container active">
                <div id="form-work-wrapper">
                    <!-- N·ªôi dung Form 3 ƒë∆∞·ª£c JS t·∫°o ra -->
                </div>
            </div>
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        let currentFormTitle = "";

        const dataCommon = {
            studio_ten: params.get('ten_studio') || "2H STUDIO",
            studio_dc: params.get('dia_chi_studio') || "85 H·ªì VƒÉn Hu√™, P.9, Q.PN, TP.HCM",
            studio_hl: params.get('hotline_studio') || "037 893 2005",
            ngay_lap: params.get('ngay') || params.get('ngay_tao') || new Date().toISOString().split('T')[0]
        };

        const dataHandover = { id: params.get('id') || ".........." };
        const dataInvoice = {
            so_phieu: params.get('so_hd') || "..........",
            ma_hd: params.get('ma_hd') || params.get('id') || "..........",
            khach_ten: params.get('khach') || "",
            khach_sdt: params.get('sdt') || "",
            khach_dc: params.get('diachi') || ""
        };
        const dataWork = {
            id_cv: params.get('id') || "..........",
            khach_ten: params.get('khach') || "",
            khach_sdt: params.get('sdt') || "",
            khach_dc: params.get('diachi') || "",
            dich_vu: params.get('dv') || "",
            goi_chup: params.get('goi') || "",
            ngay_lam: params.get('ngay_lam') || "",
            time: params.get('time') || "",
            dia_diem: params.get('diadiem') || "Studio",
            ghi_chu: params.get('ghichu') || "",
            nv_chinh: params.get('nv') || ""
        };

        // 1. RENDER FORM GIAO NH·∫¨N
        function renderHandover() {
            const container = document.getElementById('form-handover');
            const d = new Date(dataCommon.ngay_lap);
            let rowsHtml = '';
            for (let i=0; i<10; i++) rowsHtml += `<tr><td>${i+1}</td><td></td><td></td><td></td><td></td><td></td></tr>`;

            const createSigBlock = (title, actionDate) => `
                <div class="sig-block">
                    <div class="sig-header-row"><span class="sig-section-title">${title}</span><span class="italic">${actionDate}</span></div>
                    <div class="sig-grid">
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi l·∫≠p phi·∫øu</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi giao h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                        <div class="sig-col"><div class="sig-role">Ng∆∞·ªùi nh·∫≠n h√†ng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                        <div class="sig-col"><div class="sig-role">K·∫ø to√°n tr∆∞·ªüng</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                        <div class="sig-col"><div class="sig-role">ƒê·∫°i di·ªán Studio</div><div class="sig-note">(K√Ω, ƒë√≥ng d·∫•u)</div><div class="sig-space"></div></div>
                    </div>
                </div>`;

            container.innerHTML = `
                <div class="header-section">
                    <div><span class="bold" style="font-size:11pt">${dataCommon.studio_ten}</span><br>ƒêC: ${dataCommon.studio_dc}<br>Hotline: ${dataCommon.studio_hl}</div>
                    <div class="right">S·ªë: <span class="bold">${dataHandover.id}</span></div>
                </div>
                <h1 class="main-title">B·∫¢N GIAO NH·∫¨N V·∫¨T T∆Ø, TRANG PH·ª§C</h1>
                <div class="center italic" style="margin-bottom:15px">Ng√†y ${d.getDate()} th√°ng ${d.getMonth()+1} nƒÉm ${d.getFullYear()}</div>
                <div style="margin-bottom:10px;">
                    <div style="display:flex; margin-bottom:5px"><span class="bold" style="min-width:150px">Ng∆∞·ªùi nh·∫≠n h√†ng:</span><span style="border-bottom:1px dotted #000; flex:1"></span></div>
                    <div style="display:flex; margin-bottom:5px"><span class="bold" style="min-width:150px">ƒê·ªãa ch·ªâ (B·ªô ph·∫≠n):</span><span style="border-bottom:1px dotted #000; flex:1"></span></div>
                    <div style="display:flex; margin-bottom:5px"><span class="bold" style="min-width:150px">L√Ω do xu·∫•t h√†ng:</span><span style="border-bottom:1px dotted #000; flex:1"></span></div>
                </div>
                <table><thead><tr><th style="width:40px">STT</th><th>T√™n h√†ng h√≥a - Quy c√°ch</th><th style="width:50px">SL</th><th style="width:100px">ƒê∆°n gi√°</th><th style="width:100px">Th√†nh ti·ªÅn</th><th style="width:100px">Ghi ch√∫</th></tr></thead><tbody>${rowsHtml}</tbody></table>
                ${createSigBlock("1. Xu·∫•t h√†ng:", "Xu·∫•t ng√†y...... th√°ng ...... nƒÉm ......")}
                ${createSigBlock("2. Nh·∫≠p h√†ng:", "Nh·∫≠p ng√†y...... th√°ng ...... nƒÉm ......")}
                ${createSigBlock("3. H√†ng m·∫•t h·ªèng:", "K√Ω nh·∫≠n ng√†y...... th√°ng ...... nƒÉm ......")}
            `;
        }

        // 2. RENDER FORM H√ìA ƒê∆†N
        function createInvoiceHtml() {
            const d = new Date(dataCommon.ngay_lap);
            const dateStr = `Ng√†y ${d.getDate().toString().padStart(2,'0')} th√°ng ${(d.getMonth()+1).toString().padStart(2,'0')} nƒÉm ${d.getFullYear()}`;
            let rowsHtml = '';
            for(let i=0; i<5; i++) rowsHtml += `<tr><td class="center">${i+1}</td><td></td><td></td><td></td><td></td></tr>`;

            return `
                <div class="header-section">
                    <div><span class="bold" style="font-size:11pt">${dataCommon.studio_ten}</span><br>Hotline: ${dataCommon.studio_hl}</div>
                    <div class="right">Quy·ªÉn s·ªë: ..........<br>S·ªë: <span class="bold">${dataInvoice.so_phieu}</span><br>M√£ Hƒê: <span class="bold">${dataInvoice.ma_hd}</span></div>
                </div>
                <h1 class="main-title">H√ìA ƒê∆†N B√ÅN H√ÄNG</h1>
                <div class="center italic" style="font-size:9pt; margin-bottom:5px">${dateStr}</div>
                <div class="info-grid">
                    <div><div class="form-row"><span class="label">Ng∆∞·ªùi b√°n:</span><span class="value">${dataCommon.studio_ten}</span></div><div class="form-row"><span class="label">SƒêT:</span><span class="value">${dataCommon.studio_hl}</span></div><div class="form-row"><span class="label">ƒê·ªãa ch·ªâ:</span><span class="value">${dataCommon.studio_dc}</span></div></div>
                    <div><div class="form-row"><span class="label">Ng∆∞·ªùi mua:</span><span class="value">${dataInvoice.khach_ten}</span></div><div class="form-row"><span class="label">SƒêT:</span><span class="value">${dataInvoice.khach_sdt}</span></div><div class="form-row"><span class="label">ƒê·ªãa ch·ªâ:</span><span class="value">${dataInvoice.khach_dc}</span></div></div>
                </div>
                <table><thead><tr><th style="width:35px">STT</th><th>T√äN H√ÄNG - D·ªäCH V·ª§</th><th style="width:40px">SL</th><th style="width:80px">ƒê∆†N GI√Å</th><th style="width:90px">TH√ÄNH TI·ªÄN</th></tr></thead><tbody>${rowsHtml}</tbody><tfoot><tr><td colspan="4" class="right bold">T·ªîNG C·ªòNG</td><td class="bold"></td></tr></tfoot></table>
                <div style="margin-top:2px; font-style:italic; font-size:9pt">Th√†nh ti·ªÅn (vi·∫øt b·∫±ng ch·ªØ): .........................................................................................................................</div>
                <div class="signatures">
                    <div class="sig-col"><div class="sig-title">NG∆Ø·ªúI L·∫¨P PHI·∫æU</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                    <div class="sig-col"><div class="sig-title">NG∆Ø·ªúI MUA H√ÄNG</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                    <div class="sig-col"><div class="sig-title">TH·ª¶ QU·ª∏</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                    <div class="sig-col"><div class="sig-title">K·∫æ TO√ÅN</div><div class="sig-note">(K√Ω, h·ªç t√™n)</div><div class="sig-space"></div></div>
                    <div class="sig-col"><div class="sig-title">ƒê·∫†I DI·ªÜN ƒê∆†N V·ªä</div><div class="sig-note">(K√Ω, ƒë√≥ng d·∫•u)</div><div class="sig-space"></div></div>
                </div>
            `;
        }
        function renderInvoice() {
            const container = document.getElementById('form-invoice');
            const lien1 = document.createElement('div'); lien1.id='inv-lien-1'; lien1.className='voucher-section-half top'; lien1.innerHTML=createInvoiceHtml();
            const sep = document.createElement('div'); sep.id='inv-separator'; sep.className='middle-gap'; sep.innerHTML='<div class="cut-line"></div>';
            const lien2 = document.createElement('div'); lien2.id='inv-lien-2'; lien2.className='voucher-section-half bottom'; lien2.innerHTML=createInvoiceHtml();
            container.innerHTML=''; container.appendChild(lien1); container.appendChild(sep); container.appendChild(lien2);
        }

        // 3. RENDER FORM X√ÅC NH·∫¨N C√îNG VI·ªÜC (COMPACT A4 - 3mm Padding)
        function renderWorkConf() {
            const container = document.getElementById('form-work-wrapper');
            const d = new Date(dataCommon.ngay_lap);
            const dateStr = `Ng√†y ${d.getDate().toString().padStart(2,'0')} th√°ng ${(d.getMonth()+1).toString().padStart(2,'0')} nƒÉm ${d.getFullYear()}`;
            const roles = ["Nhi·∫øp ·∫£nh gia", "Makeup", "Ph·ª• t√°", "T∆∞ v·∫•n vi√™n"];
            let ekipRows = '';
            for(let i=0; i<4; i++) {
                let name = (i===0) ? dataWork.nv_chinh : "";
                ekipRows += `<tr><td class="center">${i+1}</td><td>${roles[i]}</td><td>${name}</td></tr>`;
            }

            container.innerHTML = `
                <div class="header-section">
                    <div><span class="studio-name">${dataCommon.studio_ten}</span><span class="studio-info">ƒêC: ${dataCommon.studio_dc}</span><span class="studio-info">Hotline: ${dataCommon.studio_hl}</span></div>
                    <div class="right"><span class="bold">S·ªë: ${dataWork.id_cv}</span></div>
                </div>
                <h1 class="main-title">BI√äN B·∫¢N X√ÅC NH·∫¨N C√îNG VI·ªÜC</h1>
                <div class="date-sub">${dateStr}</div>
                <div class="info-grid">
                    <div class="info-row"><span class="label">Kh√°ch h√†ng:</span><span class="value bold" style="margin-right:10px">${dataWork.khach_ten}</span><span class="label">SƒêT:</span><span class="value bold" style="flex:0 0 100px">${dataWork.khach_sdt}</span></div>
                    <div class="info-row"><span class="label">ƒê·ªãa ch·ªâ:</span><span class="value">${dataWork.khach_dc}</span></div>
                </div>
                <div class="section-title">I. TH√îNG TIN D·ªäCH V·ª§</div>
                <div class="info-grid">
                    <div class="info-row"><span class="label">H·∫°ng m·ª•c:</span><span class="value">${dataWork.dich_vu}</span><span class="label" style="margin-left:10px">G√≥i ch·ª•p:</span><span class="value">${dataWork.goi_chup}</span></div>
                    <div class="info-row"><span class="label">Ng√†y l√†m:</span><span class="value bold">${dataWork.ngay_lam}</span><span class="label" style="margin-left:10px">Th·ªùi gian:</span><span class="value">${dataWork.time}</span></div>
                    <div class="info-row"><span class="label">ƒê·ªãa ƒëi·ªÉm:</span><span class="value">${dataWork.dia_diem}</span></div>
                    <div class="info-row"><span class="label">Ghi ch√∫:</span><span class="value italic">${dataWork.ghi_chu}</span></div>
                </div>
                <div class="section-title">II. DANH S√ÅCH NH√ÇN VI√äN TH·ª∞C HI·ªÜN (EKIP)</div>
                <table class="ekip-table"><thead><tr><th style="width:40px">STT</th><th style="width:150px">V·ªã tr√≠ / C√¥ng vi·ªác</th><th>T√™n nh√¢n vi√™n</th></tr></thead><tbody>${ekipRows}</tbody></table>
                <div class="section-title">III. N·ªòI DUNG C√îNG VI·ªÜC ƒê√É TH·ª∞C HI·ªÜN</div>
                <table class="check-table">
                    <thead><tr><th class="col-time">Th·ªùi gian</th><th class="col-role">Ph·ª• tr√°ch</th><th>N·ªôi dung</th><th class="col-check">C√≥</th><th class="col-check">Kh√¥ng</th></tr></thead>
                    <tbody>
                        <tr><td rowspan="14" class="col-time">TR∆Ø·ªöC<br>BU·ªîI CH·ª§P</td><td rowspan="4" class="col-role">T∆Ø V·∫§N VI√äN</td><td>L·∫≠p nh√≥m ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>Th√¥ng b√°o chu·∫©n b·ªã: Gi√†y t√¢y, s∆°mi tr·∫Øng/m√†u, gi√†y cao g√≥t, lens, trang ph·ª•c...</td><td></td><td></td></tr>
                        <tr><td>Th√¥ng b√°o th·ªùi gian, ƒë·ªãa ƒëi·ªÉm, chi ph√≠ di chuy·ªÉn/v√©/ƒÉn u·ªëng ekip</td><td></td><td></td></tr>
                        <tr><td>Gi·ªõi thi·ªáu ekip (Th√¥ng b√°o ekip tr·ª±c ti·∫øp t∆∞ v·∫•n v·ªÅ h√¨nh ·∫£nh v√† makeup)</td><td></td><td></td></tr>
                        <tr><td rowspan="5" class="col-role">EKIP</td><td>Nhi·∫øp ·∫£nh gia th√¥ng b√°o kh√°ch h√†ng g·ª≠i h√¨nh ·∫£nh mong mu·ªën ch·ª•p v√†o nh√≥m</td><td></td><td></td></tr>
                        <tr><td>Nhi·∫øp ·∫£nh gia t∆∞ v·∫•n g√≥c ch·ª•p ph√π h·ª£p v·ªõi ƒëi·ªÉm ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>Nhi·∫øp ·∫£nh gia t∆∞ v·∫•n trang ph·ª•c t·ª± do, ph·ª• ki·ªán deco ph√π h·ª£p v·ªõi ƒëi·ªÉm ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>Makeup th√¥ng b√°o kh√°ch h√†ng g·ª≠i h√¨nh ·∫£nh ki·ªÉu t√≥c, tone makeup v√†o nh√≥m</td><td></td><td></td></tr>
                        <tr><td>Makeup t∆∞ v·∫•n th√™m: t√≥c gi·∫£, nail, lens, ph·ª• ki·ªán... c·ªßa kh√°ch tr∆∞·ªõc bu·ªïi ch·ª•p</td><td></td><td></td></tr>
                        <tr><td rowspan="3" class="col-role">KH√ÅCH H√ÄNG</td><td>G·ª≠i y√™u c·∫ßu v√† h√¨nh ·∫£nh c·∫ßn ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>G·ª≠i y√™u c·∫ßu v·ªÅ tone makeup, ki·ªÉu t√≥c</td><td></td><td></td></tr>
                        <tr><td>Y√™u c·∫ßu ƒë∆∞·ª£c t∆∞ v·∫•n tr∆∞·ªõc v·ªÅ g√≥c m√°y, th·ªùi gian v√† ƒë·ªãa ƒëi·ªÉm</td><td></td><td></td></tr>
                        <tr><td rowspan="2" class="col-role">PH·ª§ T√Å</td><td>Ph·ª• t√° chu·∫©n b·ªã hoa, n∆°, c√† v·∫°t, voan cho bu·ªïi ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>Ph·ª• t√° h·ªó tr·ª£ ch√∫ r·ªÉ th·ª≠ vest, vu·ªët t√≥c</td><td></td><td></td></tr>
                        <tr><td rowspan="10" class="col-time">TRONG<br>BU·ªîI CH·ª§P</td><td rowspan="6" class="col-role">EKIP</td><td>Nhi·∫øp ·∫£nh gia t∆∞ v·∫•n g√≥c ch·ª•p cho kh√°ch h√†ng</td><td></td><td></td></tr>
                        <tr><td>Makeup t∆∞ v·∫•n tone makeup, ki·ªÉu t√≥c v√† ph·ª• ki·ªán cho kh√°ch h√†ng</td><td></td><td></td></tr>
                        <tr><td>Nhi·∫øp ·∫£nh gia ch·ª•p theo s·ªü th√≠ch c·ªßa kh√°ch h√†ng</td><td></td><td></td></tr>
                        <tr><td>Makeup h·ªó tr·ª£ v√† th·ª±c hi·ªán theo y√™u c·∫ßu c·ªßa kh√°ch h√†ng</td><td></td><td></td></tr>
                        <tr><td>Nhi·∫øp ·∫£nh gia cho kh√°ch h√†ng check ·∫£nh tr√™n m√°y ·∫£nh</td><td></td><td></td></tr>
                        <tr><td>Makeup h·ªèi √Ω ki·∫øn c·ªßa kh√°ch h√†ng sau khi ho√†n thi·ªán, ch·ªânh s·ª≠a theo √Ω kh√°ch</td><td></td><td></td></tr>
                        <tr><td rowspan="4" class="col-role">KH√ÅCH H√ÄNG</td><td>Y√™u c·∫ßu xem h√¨nh ·∫£nh c·ªßa bu·ªïi ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>Kh√°ch h√†ng ƒë·ªÅ xu·∫•t ch·ªânh s·ª≠a h√¨nh ·∫£nh c·ªßa bu·ªïi ch·ª•p</td><td></td><td></td></tr>
                        <tr><td>Kh√°ch h√†ng h√†i l√≤ng v·ªÅ h√¨nh ·∫£nh g·ªëc</td><td></td><td></td></tr>
                        <tr><td>Kh√°ch h√†ng h√†i l√≤ng v·ªÅ tone makeup v√† ki·ªÉu t√≥c</td><td></td><td></td></tr>
                    </tbody>
                </table>
                <div class="section-title" style="margin-top:2px">IV. ƒê√ÅNH GI√Å CH·∫§T L∆Ø·ª¢NG</div>
                <table class="eval-table">
                    <thead><tr><th style="width:20%">H·∫†NG M·ª§C / ƒêI·ªÇM</th><th style="width:8%">T·ªët</th><th style="width:8%">Kh√°</th><th style="width:8%">TB</th><th style="width:8%">K√©m</th><th>L√Ω do</th></tr></thead>
                    <tbody>
                        <tr><td class="center bold">STUDIO</td><td></td><td></td><td></td><td></td><td></td></tr>
                        <tr><td class="center bold">NHI·∫æP ·∫¢NH GIA</td><td></td><td></td><td></td><td></td><td></td></tr>
                        <tr><td class="center bold">MAKEUP</td><td></td><td></td><td></td><td></td><td></td></tr>
                        <tr><td class="center bold">PH·ª§ T√Å</td><td></td><td></td><td></td><td></td><td></td></tr>
                        <tr><td class="center bold">T∆Ø V·∫§N VI√äN</td><td></td><td></td><td></td><td></td><td></td></tr>
                    </tbody>
                </table>
                <div style="margin-top:2px; font-size:8.5pt"><span class="bold">Kh√°ch h√†ng bi·∫øt t·ªõi Studio qua ƒë√¢u:</span> &nbsp; [ ] B·∫°n b√® &nbsp; [ ] Facebook &nbsp; [ ] Tiktok &nbsp; [ ] Kh√°c</div>
                <div class="footer-note">Kh√°ch h√†ng cam k·∫øt nh·ªØng n·ªôi dung tr√™n ho√†n to√†n ƒë√∫ng s·ª± th·∫≠t, tr∆∞·ªùng h·ª£p kh√°ch h√†ng khi·∫øu n·∫°i kh√°c c√°c h·∫°ng m·ª•c ƒë√£ ƒë√°nh gi√° sau khi phi·∫øu ƒë√°nh gi√° ƒë∆∞·ª£c k√Ω x√°c nh·∫≠n s·∫Ω kh√¥ng ƒë∆∞·ª£c ch·∫•p nh·∫≠n. 2H Studio xin c·∫£m ∆°n qu√Ω kh√°ch h√†ng ƒë√£ tin t∆∞·ªüng v√† s·ª≠ d·ª•ng d·ªãch v·ª• t·∫°i studio.</div>
                <div class="signatures">
                    <div class="sig-col"><div class="sig-title">KH√ÅCH H√ÄNG</div><div class="sig-note">(K√Ω, x√°c nh·∫≠n)</div><div class="sig-name">${dataWork.khach_ten}</div></div>
                    <div class="sig-col"><div class="sig-title">NHI·∫æP ·∫¢NH GIA</div><div class="sig-note">(K√Ω, x√°c nh·∫≠n)</div><div class="sig-name">${dataWork.nv_chinh}</div></div>
                    <div class="sig-col"><div class="sig-title">MAKEUP</div><div class="sig-note">(K√Ω, x√°c nh·∫≠n)</div><div class="sig-name"></div></div>
                    <div class="sig-col"><div class="sig-title">T∆Ø V·∫§N VI√äN</div><div class="sig-note">(K√Ω, x√°c nh·∫≠n)</div><div class="sig-name"></div></div>
                </div>
            `;
        }

        function switchForm(formId) {
            document.querySelectorAll('.form-container').forEach(el => el.classList.remove('active'));
            document.getElementById(formId).classList.add('active');
            const invControls = document.getElementById('invoice-controls');
            if(formId === 'form-invoice') {
                invControls.classList.remove('hidden');
                currentFormTitle = "HD_" + dataInvoice.ma_hd;
            } else {
                invControls.classList.add('hidden');
                if(formId === 'form-work') currentFormTitle = "CV_" + dataWork.id_cv;
                else currentFormTitle = "GIAONHAN_" + dataHandover.id;
            }
            document.title = currentFormTitle;
        }

        function changeInvoiceMode(mode) {
            const l1 = document.getElementById('inv-lien-1');
            const l2 = document.getElementById('inv-lien-2');
            const sep = document.getElementById('inv-separator');
            if(l1) {
                l1.classList.remove('hidden'); l2.classList.remove('hidden'); sep.classList.remove('hidden');
                if(mode==='lien1') { l2.classList.add('hidden'); sep.classList.add('hidden'); }
                if(mode==='lien2') { l1.classList.add('hidden'); sep.classList.add('hidden'); }
            }
        }

        function downloadPDF() {
            const activeForm = document.querySelector('.form-container.active');
            let filename = currentFormTitle;
            if(activeForm.id === 'form-invoice') {
                const mode = document.getElementById('invoice-print-mode').value;
                if(mode !== 'both') filename += '_' + mode;
            }
            const opt = { margin: 0, filename: filename + '.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2, useCORS: true }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
            html2pdf().from(activeForm).set(opt).save();
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderHandover();
            renderInvoice();
            renderWorkConf();
            switchForm('form-work');
            document.getElementById('main-form-selector').value = 'form-work';
        });

    </script>
</body>
</html>
